# Webhook 管理系统 - 前端操作手册

## 目录

1. [系统概述](#系统概述)
2. [环境要求](#环境要求)
3. [安装与启动](#安装与启动)
4. [功能模块](#功能模块)
5. [页面操作指南](#页面操作指南)
6. [配置说明](#配置说明)
7. [常见问题](#常见问题)

---

## 系统概述

前端应用基于 **React + Vite** 构建，提供现代化的 Webhook 管理界面，主要功能包括：

- **用户认证**：登录/登出/修改密码
- **数据概览**：统计信息和趋势图表
- **Webhook 管理**：创建、编辑、删除、查看详情
- **历史记录**：查看和筛选请求日志

### 技术栈

| 技术         | 版本     | 用途        |
| ------------ | -------- | ----------- |
| React        | ^19.0.0  | UI 框架     |
| Vite         | ^6.0.7   | 构建工具    |
| TypeScript   | ~5.7.2   | 类型系统    |
| Ant Design   | ^5.23.4  | UI 组件库   |
| Zustand      | ^5.0.3   | 状态管理    |
| React Router | ^7.1.3   | 路由管理    |
| Axios        | ^1.7.9   | HTTP 客户端 |
| Recharts     | -        | 图表库      |
| Tailwind CSS | ^3.4.17  | 样式框架    |
| Day.js       | ^1.11.13 | 日期处理    |

---

## 环境要求

### 系统要求

- **Node.js**: >= 18.0.0
- **npm**: >= 9.0.0
- **现代浏览器**: Chrome, Firefox, Safari, Edge (最新版本)

### 后端服务

前端需要后端 API 服务正常运行：

- 默认后端地址：`http://localhost:3000`
- API 前缀：`/api`
- Webhook 接收前缀：`/hook`

---

## 安装与启动

### 1. 安装依赖

```bash
# 在项目根目录执行
npm install

# 或仅安装前端依赖
cd packages/frontend
npm install
```

### 2. 启动开发服务器

```bash
cd packages/frontend
npm run dev
```

服务将在 `http://localhost:5173` 启动，支持热模块替换 (HMR)。

### 3. 生产构建

```bash
# 构建生产版本
npm run build

# 预览生产构建
npm run preview
```

构建产物位于 `packages/frontend/dist` 目录。

---

## 功能模块

### 系统架构

```
┌─────────────────────────────────────────────────────┐
│                    App Layout                        │
├──────────┬──────────────────────────────────────────┤
│          │                                           │
│ Sidebar  │              Main Content                 │
│          │                                           │
│ - 数据概览│  ┌─────────────────────────────────────┐  │
│ - Webhook│  │                                      │  │
│   管理   │  │         Page Component               │  │
│ - 历史   │  │                                      │  │
│   记录   │  │  (Dashboard / Webhooks / History)   │  │
│          │  │                                      │  │
│          │  └─────────────────────────────────────┘  │
│          │                                           │
│  v1.0.0  │                                           │
└──────────┴──────────────────────────────────────────┘
```

### 页面路由

| 路径            | 页面         | 说明                    |
| --------------- | ------------ | ----------------------- |
| `/login`        | 登录页       | 用户登录                |
| `/`             | 数据概览     | Dashboard 统计信息      |
| `/webhooks`     | Webhook 管理 | Webhook 列表和操作      |
| `/webhooks/:id` | Webhook 详情 | 单个 Webhook 详情和日志 |
| `/history`      | 历史记录     | 所有请求日志            |

---

## 页面操作指南

### 1. 登录页面

![登录页面示意]

**操作步骤**:

1. 输入用户名（必填）
2. 输入密码（必填）
3. 点击「登录」按钮

**默认管理员账户**:
| 字段 | 值 |
|------|------|
| 用户名 | `admin` |
| 密码 | `admin` |

> ⚠️ **安全提示**：首次登录后请立即修改默认密码！

**注意事项**:

- 登录成功后自动跳转到数据概览页面
- 登录状态保存在浏览器本地存储中
- 7 天内无需重新登录（取决于 JWT 过期时间）

---

### 2. 数据概览 (Dashboard)

![Dashboard 示意]

**功能区域**:

#### 2.1 统计卡片

显示关键指标：

- **总 Webhook 数**：已创建的 Webhook 总数
- **今日请求数**：今天接收的请求总数
- **成功率**：请求成功的百分比
- **活跃 Webhook**：当前启用的 Webhook 数量

#### 2.2 请求趋势图

- 显示近 7 天的请求趋势
- 区分成功和失败请求
- 支持鼠标悬停查看详情

#### 2.3 最近活动

- 显示最新的 Webhook 请求记录
- 包含时间、方法、状态等信息

---

### 3. Webhook 管理

![Webhook 管理示意]

#### 3.1 Webhook 列表

**表格列**:
| 列名 | 说明 |
|------|------|
| 名称 | Webhook 名称 |
| 接收地址 | 完整的 Webhook URL（可复制） |
| 密钥 | 是否设置了验证密钥 |
| 状态 | 启用/禁用状态 |
| 创建时间 | 创建日期时间 |
| 操作 | 查看、编辑、删除按钮 |

**操作按钮**:

- **新建 Webhook**：打开创建弹窗
- **复制 URL**：复制 Webhook 接收地址到剪贴板
- **查看**：跳转到详情页面
- **编辑**：打开编辑弹窗
- **删除**：删除 Webhook（需确认）

#### 3.2 创建/编辑 Webhook

**表单字段**:

| 字段     | 必填 | 说明                                             |
| -------- | ---- | ------------------------------------------------ |
| 名称     | 是   | Webhook 名称，1-100 个字符                       |
| 路径     | 是   | URL 路径标识，只能包含字母、数字、下划线和连字符 |
| 密钥     | 否   | 可选的验证密钥，用于请求验证                     |
| 启用状态 | 否   | 是否接收请求（默认启用）                         |

**路径说明**:

- 路径用于构建接收 URL：`http://your-domain/hook/<路径>`
- 创建后路径不可修改
- 路径在系统中必须唯一

**密钥验证**:
如果设置了密钥，外部请求需要提供密钥才能成功：

- 请求头方式：`x-webhook-secret: your-secret`
- 查询参数方式：`?secret=your-secret`

#### 3.3 删除 Webhook

1. 点击列表中的「删除」按钮
2. 在确认弹窗中点击「确定」
3. Webhook 及其所有请求日志将被删除

> ⚠️ **警告**：删除操作不可恢复！

---

### 4. Webhook 详情

![Webhook 详情示意]

**信息展示**:

- **基本信息**：ID、路径、接收地址、密钥状态、创建时间
- **请求日志**：所有接收到的请求记录

**请求日志表格**:
| 列名 | 说明 |
|------|------|
| 时间 | 请求接收时间 |
| 方法 | HTTP 方法 (GET/POST 等) |
| 状态 | 响应状态码 |
| 操作 | 查看详情按钮 |

**查看请求详情**:
点击「查看详情」可查看：

- 请求方法和状态码
- 接收时间
- 完整请求头（敏感信息已脱敏）
- 请求体 (JSON 格式)
- 响应内容

**刷新日志**:
点击「刷新」按钮获取最新请求记录。

---

### 5. 修改密码

用户可以通过页面右上角的用户菜单修改密码。

**操作步骤**:

1. 点击页面右上角的用户头像
2. 在下拉菜单中选择「修改密码」
3. 在弹窗中填写以下信息：
   - **当前密码**：输入现有密码
   - **新密码**：输入新密码（至少 6 个字符）
   - **确认新密码**：再次输入新密码
4. 点击「确认修改」按钮

**注意事项**:

- 新密码长度至少为 6 个字符
- 两次输入的新密码必须一致
- 修改成功后系统会自动登出，需要使用新密码重新登录

**错误提示**:
| 提示信息 | 原因 |
|----------|------|
| 当前密码错误 | 输入的当前密码不正确 |
| 两次输入的密码不一致 | 新密码与确认密码不匹配 |
| 密码长度至少 6 个字符 | 新密码太短 |

---

### 6. 历史记录

![历史记录示意]

**筛选条件**:
| 条件 | 说明 |
|------|------|
| Webhook | 选择特定 Webhook 或查看全部 |
| 时间范围 | 选择日期范围 |
| 状态 | 筛选成功/失败请求 |

**操作步骤**:

1. 设置筛选条件
2. 点击「搜索」按钮
3. 在表格中查看结果
4. 点击「查看」查看请求详情

---

## 配置说明

### Vite 配置

文件：`packages/frontend/vite.config.ts`

```typescript
export default defineConfig({
  plugins: [react()],
  server: {
    port: 5173,
    proxy: {
      "/api": {
        target: "http://localhost:3000",
        changeOrigin: true,
      },
      "/hook": {
        target: "http://localhost:3000",
        changeOrigin: true,
      },
    },
  },
});
```

**说明**:

- 开发环境通过 Vite 代理转发 API 请求
- `/api` 前缀的请求转发到后端
- `/hook` 前缀的请求转发到后端

### 生产环境部署

生产环境需要配置 Nginx 或其他反向代理：

```nginx
server {
    listen 80;
    server_name your-domain.com;

    # 前端静态文件
    location / {
        root /path/to/frontend/dist;
        try_files $uri $uri/ /index.html;
    }

    # API 代理
    location /api {
        proxy_pass http://localhost:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    # Webhook 代理
    location /hook {
        proxy_pass http://localhost:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

---

## 常见问题

### 1. 页面显示空白

**可能原因**:

- JavaScript 加载失败
- 浏览器版本过低

**解决方案**:

```bash
# 清除浏览器缓存
# 或使用强制刷新 Ctrl+Shift+R (Windows) / Cmd+Shift+R (Mac)
```

### 2. 登录失败

**错误信息**: "登录失败，请检查用户名和密码"

**检查项**:

- 确认后端服务正在运行
- 确认用户名和密码正确
- 检查浏览器控制台错误信息

### 3. API 请求失败

**错误信息**: "Network Error" 或 "CORS error"

**解决方案**:

1. 确认后端服务正在运行
2. 确认 Vite 代理配置正确
3. 检查后端 CORS 配置

### 4. 页面样式异常

**可能原因**:

- CSS 文件加载失败
- 浏览器缓存

**解决方案**:

```bash
# 重新构建
npm run build

# 清除缓存后刷新
```

### 5. 复制 URL 失败

**可能原因**: 浏览器不支持 Clipboard API

**解决方案**:

- 使用 HTTPS 协议
- 使用支持 Clipboard API 的现代浏览器

### 6. 图表不显示

**可能原因**: recharts 库未正确加载

**解决方案**:

```bash
# 重新安装依赖
cd packages/frontend
npm install recharts
```

---

## 快捷键

| 快捷键                 | 功能                 |
| ---------------------- | -------------------- |
| `Ctrl/Cmd + R`         | 刷新页面             |
| `Ctrl/Cmd + Shift + R` | 强制刷新（清除缓存） |
| `F12`                  | 打开开发者工具       |

---

## 浏览器兼容性

| 浏览器  | 最低版本 |
| ------- | -------- |
| Chrome  | 90+      |
| Firefox | 88+      |
| Safari  | 14+      |
| Edge    | 90+      |

> ⚠️ 不支持 Internet Explorer

---

## 联系支持

如有问题，请联系系统管理员或查看项目 Issue。
